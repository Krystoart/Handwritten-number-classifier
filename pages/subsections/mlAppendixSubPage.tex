\subsection{Mašīnmācīšanās modelis}

    Šajā sadaļā tiks apskatītas tikai galvenās koda daļas, gan priekš
    modeļa apmācīšanas, gan modeļa implementācijas.

    Trenēšanas procesā bija nepieciešams \texttt{MNIST} datus sakārtotā formā uzglabāt atmiņā, tāpēc
    tika izveidotas 2 klases: \texttt{MnistList} un \texttt{MnistItem}. \texttt{MnistItem} klase tieši
    uzglabā pikseļu vērtības un attiecīgo bildes ciparu. \texttt{MnistList} ir klases mainīgais, kurā
    tiek uzglabāts masīvs ar \texttt{MnistItem} klasēm. \texttt{MnistItem} ir klase, kurā tiek uzglabāta
    viena bilde un šīs bildes cipars. Šai klasei ir 2 galvenie mainīgie: \texttt{Pixels}, kas ir masīvs
    ar float vērtībām, un \texttt{Label}, kas ir float vērtība. Lai ielasītu datus, ir izveidota parsēšanas
    funkcija, kas ir \texttt{MnistList} konstruktors, un to ir iespējams apskatīt sekojoši:

    \input{pages/code/mnistList.tex}

    Par piemēru šīm klasēm tika ņemts \texttt{GitHub} piemērs \cite{paxbunPaxbunCntkMnistPractice2019}.
    \texttt{MNIST} dati ir binārie dati un to pikseļu vērtības ir intervālā no 0 līdz 255,
    bet, ja modelim tiks doti normalizēti dati, kas ir vērtībās no 0 līdz 1, tad tas
    uztrenēsies labāk. Tāpēc \texttt{MnistItem} klases konstruktorā šie dati tiek
    normalizēti.

    \input{pages/code/mnistItem.tex}

    Pēc datu ielasīšanas ir nepieciešams apmācīt modeli. Priekš tā tika izveidota funkcija, tika ņemts jau eksistējošs piemērs no \texttt{ML.NET} \texttt{GitHub}
    repozitorija \cite{DotnetMachinelearningsamples2021}. Dotajā piemērā izmantotā datu kopa
    neatbilda īstajai \texttt{MNIST} datu kopai, bet gan daudz mazākai datu kopai, tāpēc šo piemēru bija
    jāpārveido, lai tas darbotos ar nepieciešamo \texttt{MNIST} datu kopu. \cite{MNISTHandwrittenDigit}

    \input{pages/code/mlTraining.tex}

    Rezultātā tika izveidots modelis, kuru bija nepieciešams implementēt tīmekļa aplikācijā.
    Tika izveidota klase \texttt{MnistClassificator} ar metodi, kura saņem masīvu ar pikseļu vērtībām un
     atgriež masīvu ar float vērtībām, kur katrs elements
    atbilst kādai no ciparu klasēm.

    \input{pages/code/mlImplement.tex}

    Lai ielasītu modeli atmiņā un to varētu izmantot tiek izmantota \texttt{ML.NET} funkcija:
    \mintinline{csharp}{this.trainedModel = mlContext.Model.Load(ModelPath, out var modelInputSchema);}
