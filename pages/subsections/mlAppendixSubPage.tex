\subsection{Mašīnmācīšanās modelis}

    Šajā sadaļā tiks apskatītas tikai galvenās koda daļas, gan priekš
    modeļa apmācīšanas, gan modeļa implementācijas.

    Trenēšanas procesā bija nepieciešams \texttt{MNIST} datus sakārtotā formā uzglabāt atmiņā, tāpēc
    tika izveidotas 2 klases:

    \begin{itemize}
        \item \texttt{MnistList}
        \begin{itemize}
            \item \texttt{MnistItem[] Images}
        \end{itemize}
        \item \texttt{MnistItem}
        \begin{itemize}
            \item \texttt{float[] Pixels}
            \item \texttt{float Label}
        \end{itemize}
    \end{itemize}

    Sarakstā ir aprakstītas klases un šo klašu galvenie klašu mainīgie. Pēc šo klašu izveidošanas
    bija nepieciešams izveidot parsēšanu. Šī parsēšana notiek \texttt{MnistList} konstruktorā,
    un izplementāciju ir iespējams apskatīt sekojoši:

    \input{pages/code/mnistList.tex}

    Par piemēru šīm klasēm tika ņemts \texttt{GitHub} piemērs \cite{paxbunPaxbunCntkMnistPractice2019}.
    \texttt{MNIST} dati ir binārie dati un to pikseļu vērtības ir intervālā no 0 līdz 255,
    bet, ja modelim tiks doti normalizēti dati, kas ir vērtībās no 0 līdz 1, tad tas
    apmācīts labāk. Tāpēc \texttt{MnistItem} klases konstruktorā šie dati tiek
    normalizēti.

    \input{pages/code/mnistItem.tex}

    Pēc datu ielasīšanas ir nepieciešams apmācīt modeli. Priekš tā tika izveidota funkcija, tika ņemts jau eksistējošs piemērs no \texttt{ML.NET} \texttt{GitHub}
    repozitorija \cite{DotnetMachinelearningsamples2021}. Dotajā piemērā izmantotā datu kopa
    neatbilda īstajai \texttt{MNIST} datu kopai, bet gan daudz mazākai datu kopai, tāpēc šo piemēru bija
    jāpārveido, lai tas darbotos ar nepieciešamo \texttt{MNIST} datu kopu. \cite{MNISTHandwrittenDigit}

    \input{pages/code/mlTraining.tex}

    Rezultātā tika izveidots modelis, kuru bija nepieciešams implementēt tīmekļa aplikācijā.
    Tika izveidota klase \texttt{MnistClassificator} ar metodi, kura saņem masīvu ar pikseļu vērtībām un
    atgriež masīvu ar float vērtībām, kur katrs elements
    atbilst kādai no ciparu klasēm.

    \input{pages/code/mlImplement.tex}

    Lai ielasītu modeli atmiņā un to varētu izmantot tiek izmantota \texttt{ML.NET} funkcija:
    \mintinline{csharp}{this.trainedModel = mlContext.Model.Load(ModelPath, out var modelInputSchema);}
