\begin{minted}{csharp}
    public MnistList(string imagePath, string labelPath)
    {
        FileStream fsImages = new FileStream(
            imagePath, FileMode.Open
        ); // Images
        FileStream fsLabels = new FileStream(
            labelPath, FileMode.Open
        ); // Labels

        BinaryReader brImages = new BinaryReader(fsImages);
        BinaryReader brLabels = new BinaryReader(fsLabels);

        int magic1 = ReverseBytes(brImages.ReadInt32());
        int magic2 = ReverseBytes(brLabels.ReadInt32());

        // Tests if dataset magic numbers are correct
        if (magic1 != 2051)
            throw new Exception("Not a valid MNIST image data set");

        if (magic2 != 2049)
            throw new Exception("Not a valid MNIST label data set");

        int imgCount = ReverseBytes(brImages.ReadInt32());
        int labelCount = ReverseBytes(brLabels.ReadInt32());

        // Checks if for each image there is a label
        if (imgCount != labelCount)
            throw new Exception(
                "Number of items of the two files is not the same"
            );

        int imgRows = ReverseBytes(brImages.ReadInt32());
        int imgCols = ReverseBytes(brImages.ReadInt32());

        this.Length = imgCount;
        this.Rows = imgRows;
        this.Columns = imgCols;

        this.images = new MnistItem[this.Length];
        byte[][] item = new byte[Rows][];
        for (int i = 0; i < item.Length; i++)
            item[i] = new byte[Columns];

        for (int di = 0; di < this.Length; ++di)
        {
            for (int i = 0; i < item.Length; ++i)
            {
                for (int j = 0; j < item.Length; j++)
                {
                    byte b = brImages.ReadByte();
                    item[i][j] = b;
                }
            }
            byte label = brLabels.ReadByte();

            MnistItem newImg = new MnistItem(
                width: 28, height: 28, pixels: item, label: label
            );
            images[di] = newImg;
        }

        fsImages.Close();
        brImages.Close();
        fsLabels.Close();
        brLabels.Close();
    }
\end{minted}