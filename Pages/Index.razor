@page "/"

@using Microsoft.AspNetCore.Components.Web;

<h1>WRITTEN NUMBER CLASSIFIER</h1>
<div class="content">
    <div class="canvas">
        <svg class="svg" width="@CanvasWidth" height="@CanvasHeight"
            @onmousedown="@OnMouseDown" @onmousemove="@Mouse_Move" @onmouseup="@OnMouseUp">
            <polyline class="poly" points="@PointString" />
        </svg>
        <div style="display:flex;flex-direction:row;margin:1em">
            <button @onclick="@ClearDrawing" class="button">
                Clear
            </button>
            <button class="button">
                Erasor
            </button>
            <button class="button">
                Guess
            </button>
        </div>
    </div>
</div>

@code {
    public string PointString;
    public double CanvasWidth;
    public double CanvasHeight;
    private bool pressed;
    protected string prevCoordinates { get; set; }
    protected string Coordinates { get; set; }

    protected override void OnInitialized()
    {
        PointString = "";
        CanvasWidth = 500;
        CanvasHeight = 500;
        pressed = false;
    }
    protected void OnMouseDown(MouseEventArgs e)
    {
        prevCoordinates = $",{e.ClientY - 162} {e.ClientX}";
        if(String.IsNullOrEmpty(PointString)){
            PointString = PointString + $"{e.ClientY - 162}";
        }
        PointString = PointString + prevCoordinates;
        pressed = true;
    }
    protected void OnMouseUp(MouseEventArgs e)
    {
        pressed = false;
    }
    protected void Mouse_Move(MouseEventArgs e)
    {
        if(!pressed)return;
        Coordinates = $",{e.ClientY - 162} {e.ClientX}";
        PointString = PointString + Coordinates;
        prevCoordinates = Coordinates;
    }
    protected void Add_Point(MouseEventArgs e)
    {
        PointString = PointString + $",{e.ClientY} {e.ClientX}";
    }

    protected void ClearDrawing(MouseEventArgs e)
    {
        PointString = "";
    }
}
